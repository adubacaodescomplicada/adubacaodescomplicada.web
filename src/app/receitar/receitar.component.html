<form [formGroup]="frm" *ngIf="frm">
    <table class="table table-striped m-4">
        <thead class="thead-dark">
            <tr>
                <th scope="col" class="align-middle" colspan="2">FOLHA DE RECOMENDAÇÃO TÉCNICA</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th scope="row" class="align-middle">NOME DO PROPRIETÁRIO</th>
                <td>
                    <b>{{frm?.value.pessoa?.nome}}</b>
                </td>
            </tr>

            <tr>
                <th scope="row" class="align-middle">Data de Preparo desta Receita</th>
                <td>
                    <mat-form-field>
                        <input matInput type="date" formControlName="data">
                        <mat-error *ngIf="frm?.controls?.data?.hasError('required')">
                            Campo Obrigatório!
                        </mat-error>
                    </mat-form-field>
                </td>
            </tr>

            <tr>
                <th scope="row" class="align-middle">Cultura</th>
                <td>
                    <mat-form-field>
                        <mat-select formControlName="cultura" [compareWith]="idListComparar"
                            (selectionChange)="culturaMudou($event, frm)">
                            <mat-optgroup *ngFor="let classificacao of culturaList" [label]="classificacao.nome">
                                <mat-option *ngFor="let cultura of classificacao.lista" [value]="cultura">
                                    {{cultura.nome}}
                                </mat-option>
                            </mat-optgroup>
                        </mat-select>
                        <mat-error *ngIf="frm?.controls.cultura.touched && frm?.controls.cultura.hasError('required')">
                            Campo Obrigatório!
                        </mat-error>
                    </mat-form-field>
                </td>
            </tr>
            <tr *ngIf="frm?.value.cultura">
                <th scope="row" class="align-middle">Tipo ({{frm?.value.cultura?.classificacao}})</th>
                <td>
                    <mat-radio-group formControlName="culturaTipo">
                        <mat-radio-button style="margin-right: 16px" value="F"
                            *ngIf="frm?.value.cultura.formacao === 'S'">
                            Formação
                        </mat-radio-button>
                        <mat-radio-button style="margin-right: 16px" value="P"
                            *ngIf="frm?.value.cultura.producao === 'S'">
                            Produção
                        </mat-radio-button>
                        <mat-radio-button style="margin-right: 16px" value="ES"
                            *ngIf="frm?.value.cultura.cultivoEmSolo === 'S'">
                            Cultivo em solo (campo)
                        </mat-radio-button>
                        <mat-radio-button style="margin-right: 16px" value="FS"
                            *ngIf="frm?.value.cultura.cultivoForaSolo === 'S'">
                            Cultivo fora do solo (semi-hidropônico)
                        </mat-radio-button>
                        <mat-radio-button style="margin-right: 16px" value="HI"
                            *ngIf="frm?.value.cultura.cultivoHidroponico === 'S'">
                            Hidropônico
                        </mat-radio-button>
                    </mat-radio-group>
                    <mat-error style="font-size: 75%;"
                        *ngIf="frm?.controls.culturaTipo.touched && frm?.controls.culturaTipo.hasError('required')">
                        Campo Obrigatório!
                    </mat-error>
                </td>
            </tr>

            <tr *ngIf="frm?.value.cultura && frm?.value.culturaTipo === 'F'">
                <th scope="row" class="align-middle">Idade Plantio</th>
                <td>
                    <mat-form-field>
                        <mat-select formControlName="idadePlantio" [compareWith]="idListComparar">
                            <mat-option *ngFor="let idadePlantio of frm?.value.cultura.culturaIdadePlantioList"
                                [value]="idadePlantio">{{idadePlantio.nome}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="frm?.controls?.idadePlantio?.hasError('required')">
                            Campo Obrigatório!
                        </mat-error>
                    </mat-form-field>
                </td>
            </tr>
            <tr *ngIf="frm?.value.cultura && frm?.value.culturaTipo === 'P'">
                <th scope="row" class="align-middle">Produtividade Esperada</th>
                <td>
                    <mat-form-field>
                        <input matInput type="number" formControlName="produtividadeEsperada">
                        <mat-error *ngIf="frm?.controls?.produtividadeEsperada?.hasError('required')">
                            Campo Obrigatório!
                        </mat-error>
                    </mat-form-field>
                </td>
            </tr>

            <tr *ngIf="frm?.value.cultura">
                <th scope="row" class="align-middle">Forma de Plantio</th>
                <td>
                    <mat-radio-group formControlName="formaPlantio">
                        <mat-radio-button style="margin-right: 16px"
                            *ngFor="let forma of frm.value.cultura.formaPlantio" [value]="forma">
                            Em {{forma | titlecase}}
                        </mat-radio-button>
                    </mat-radio-group>
                    <mat-error style="font-size: 75%;"
                        *ngIf="frm?.controls.formaPlantio.touched && frm?.controls.formaPlantio.hasError('required')">
                        Campo Obrigatório!
                    </mat-error>
                </td>
            </tr>

            <tr *ngIf="frm?.value.cultura">
                <th scope="row" class="align-middle">Referência Bibliografica</th>
                <td>
                    <mat-form-field>
                        <mat-select formControlName="referencia" (selectionChange)="referenciaChange($event)">
                            <mat-option *ngFor="let receitaReferencia of receitaReferenciaList"
                                [value]="receitaReferencia">{{receitaReferencia.nome}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="frm?.controls?.referencia?.hasError('required')">
                            Campo Obrigatório!
                        </mat-error>
                    </mat-form-field>
                </td>
            </tr>
        </tbody>
    </table>

    <mat-accordion class="example-headers-align" *ngIf="frm?.value.cultura && frm?.value.referencia">
        <!-- FRZ - ESTE CÓDIGO DENTRE DESTE COMENTÁRIO DEVE SER COLOCADO EM UMA PÁGINA À PARTE
        <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Informações
                </mat-panel-title>
                <mat-panel-description>
                    Recomendação de amostragem do solo para análise
                    <mat-icon>account_circle</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>

            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center">Recomendação de amostragem do solo para análise</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <p>
                                Para uma amostragem de solo bem feita, deve-se primeiramente dividir toda a área em
                                glebas ou talhões com características semelhantes (Figura 1). Cada gleba ou talhão
                                deve apresentar a mesma topografia (topo de morro, encosta, baixada), a mesma vegetação,
                                as mesmas características perceptíveis de solo (cor, textura, condição de drenagem) e o
                                mesmo histórico de cultivo (plantas com mesma idade, uso de fertilizantes, culturas
                                plantadas
                                anteriormente).
                            </p>
                            <table>
                                <tr>
                                    <td><img class="img-fluid img-thumbnail" src="assets/receita/i-001.png"></td>
                                    <td><img class="img-fluid img-thumbnail" src="assets/receita/i-002.png"></td>
                                </tr>
                            </table>
                            <p>
                                As amostragens devem ser feitas coletando-se amostras simples em <b>20 pontos ao
                                    acaso</b>,
                                caminhando em
                                ziguezague em cada gleba ou talhão homogêneo e com o uso de trados, enxadas ou pás
                                (Figura
                                2).
                                Misturando-se bem as amostras simples, obtém-se uma amostra composta, da qual separam-se
                                mais ou
                                menos 300 gramas em embalagens limpas. Deve-se identificar cada amostra e levar para um
                                laboratório
                                para realizar a análise de solo.
                            </p>
                            <p>
                                Para <b>áreas novas</b>, as amostras devem ser coletadas na profundidade de 0 a 20 cm e
                                20 a
                                40 cm.
                            </p>
                            <p>
                                Para <b>áreas de fruticultura já implantadas</b>, as amostras devem ser coletadas na
                                camada
                                de 0 a 20 cm na
                                <b>projeção da copa</b> para avaliação de aspectos nutricionais. Também deve ser
                                coletada
                                amostras na
                                profundidade de 0 a 20 cm nas entrelinhas ou no centro das ruas para avaliação dos
                                efeitos
                                da
                                calagem.
                            </p>
                            <p>
                                A frequência da amostragem depende do manejo da cultura. Recomenda-se amostragem anual a
                                partir da
                                fase produtiva e realizada antes do período das chuvas. E a cada três anos coletar
                                amostras
                                nas
                                camadas de 20 a 40 cm.
                            </p>
                        </td>
                    </tr>
                    <tr>
                </tbody>
            </table>
            <mat-action-row>
                <button mat-button color="primary" (click)="nextStep()">Próximo</button>
            </mat-action-row>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 1
                </mat-panel-title>
                <mat-panel-description>
                    Análise Foliar
                    <mat-icon>map</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>

            <div>
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">Recomendação de amostragem do solo para análise</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <pre> {{frm?.value.cultura.recomendacao}}</pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">Época</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <pre>
                                    {{frm?.value.cultura.epoca}}
                                </pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">Tipo de Folha</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <pre>
                                    {{frm?.value.cultura.tipoFolha}}
                                </pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">Número de folhas por gleba</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <pre>
                                    {{frm?.value.cultura.numeroFolha}}
                                </pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">Armazenagem e envio das amostras para analise em
                                laboratório</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <pre>
                                    {{frm?.value.cultura.armazanamentoEnvio}}
                                </pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">Observações para coleta</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <pre>
                                    {{frm?.value.cultura.observacaoColeta}}
                                </pre>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Proximo</button>
            </mat-action-row>
        </mat-expansion-panel>
        -->

        <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 1
                </mat-panel-title>
                <mat-panel-description>
                    Análise de Solo
                    <mat-icon>date_range</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <div class="table-responsive">
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center" colspan="4">DADOS DA ANALISE DE SOLOS</th>
                        </tr>
                        <tr>
                            <th scope="col" class="text-center">#</th>
                            <th scope="col" class="text-center">ELEMENTO</th>
                            <th scope="col" class="text-center">VALOR</th>
                            <th scope="col" class="text-center">UNIDADE</th>
                        </tr>
                    </thead>

                    <tbody formArrayName="receitaAnaliseSoloParametroList">
                        <tr>
                            <td colspan="4">
                                Deixe em branco os campos cujos dados não estejam presentes na análise laboratorial de
                                solos.
                            </td>
                        </tr>
                        <ng-template ngFor let-receitaAnaliseSoloParametro
                            [ngForOf]="frm?.get('receitaAnaliseSoloParametroList')['controls']" let-i="index">
                            <tr [formGroupName]="i"
                                [style.background-color]="receitaAnaliseSoloParametro?.value?.analiseSoloParametro?.temFormulaQualidadeSolo === 'S' ? 'silver' : ''">
                                <!-- td
                                    [attr.rowspan]="receitaAnaliseSoloParametro.value.valor && receitaAnaliseSoloParametro.value.avaliacao ? 2 : 1"
                                -->
                                <td>
                                    {{i+1}}
                                </td>
                                <td>
                                    {{receitaAnaliseSoloParametro.value.analiseSoloParametro?.nome}}
                                </td>
                                <td class="text-right">
                                    <mat-form-field>
                                        <mat-label>Valor</mat-label>
                                        <input matInput type="number" class="text-right" formControlName="valor" min="0"
                                            step="0.01"
                                            [readonly]="receitaAnaliseSoloParametro?.value?.analiseSoloParametro?.temFormulaQualidadeSolo === 'S'"
                                            [max]="receitaAnaliseSoloParametro?.value?.analiseSoloParametro?.unidadeMedida?.codigo === 'PERCENTUAL' ? 100 : null">
                                        <mat-error
                                            *ngIf="receitaAnaliseSoloParametro?.controls?.valor?.errors?.required">Campo
                                            Obrigatório!</mat-error>
                                        <mat-error *ngIf="receitaAnaliseSoloParametro?.controls?.valor?.errors?.min">
                                            Valor mínimo
                                            ({{receitaAnaliseSoloParametro?.controls?.valor?.errors?.min.min}})
                                            ultrapassado!</mat-error>
                                        <mat-error *ngIf="receitaAnaliseSoloParametro?.controls?.valor?.errors?.max">
                                            Valor máximo
                                            ({{receitaAnaliseSoloParametro?.controls?.valor?.errors?.max.max}})
                                            ultrapassado!</mat-error>
                                    </mat-form-field>
                                </td>
                                <td>
                                    <p
                                        *ngIf="receitaAnaliseSoloParametro?.value.analiseSoloParametro?.unidadeMedidaLista?.length === 1">
                                        {{receitaAnaliseSoloParametro?.value?.unidadeMedida.nome }}</p>

                                    <mat-radio-group formControlName="unidadeMedida"
                                        *ngIf="receitaAnaliseSoloParametro?.value.analiseSoloParametro?.unidadeMedidaLista?.length > 1"
                                        (change)="mudouUnidadeMedida($event, receitaAnaliseSoloParametro)">
                                        <mat-radio-button style="margin-right: 16px"
                                            *ngFor="let um of getUnidadeMedidaList(receitaAnaliseSoloParametro.value.analiseSoloParametro?.unidadeMedidaLista)"
                                            [value]="um">
                                            {{um.nome}}
                                        </mat-radio-button>
                                    </mat-radio-group>
                                    <mat-error style="font-size: 75%;"
                                        *ngIf="receitaAnaliseSoloParametro?.controls.unidadeMedida.touched && receitaAnaliseSoloParametro?.controls.unidadeMedida.hasError('required')">
                                        Campo Obrigatório!
                                    </mat-error>

                                    <!-- <p *ngIf="!receitaAnaliseSoloParametro.value.analiseSoloParametro.observacao || receitaAnaliseSoloParametro?.value?.analiseSoloParametro?.temFormulaQualidadeSolo === 'S'">
                                        {{receitaAnaliseSoloParametro.value.analiseSoloParametro?.unidadeMedida?.nome}}
                                    </p> -->

                                    <!-- <mat-form-field
                                        *ngIf="receitaAnaliseSoloParametro.value.analiseSoloParametro.observacao && receitaAnaliseSoloParametro?.value?.analiseSoloParametro?.temFormulaQualidadeSolo !== 'S'">
                                        <mat-select [compareWith]="idListComparar" formControlName="unidadeMedida">
                                            <mat-option *ngFor="let unidadeMedida of unidadeMedidaList"
                                                [value]="unidadeMedida">
                                                {{unidadeMedida.nome}}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error>Campo Obrigatório!</mat-error>
                                    </mat-form-field> -->

                                </td>
                            </tr>
                            <tr *ngIf="receitaAnaliseSoloParametro.value.analiseSoloParametro.observacao">
                                <td colspan="4">
                                    <table style="font-size: 80%; padding: 0px; margin: 0px;">
                                        <tr>
                                            <td>
                                                Observação:
                                            </td>
                                            <td>
                                                <b
                                                    [innerHTML]="receitaAnaliseSoloParametro.value.analiseSoloParametro.observacao"></b>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <!-- <tr [formGroupName]="i"
                                *ngIf="receitaAnaliseSoloParametro.value.valor && receitaAnaliseSoloParametro.value.avaliacao">
                                <td colspan="3"
                                    [ngClass]="receitaAnaliseSoloParametro.value.avaliacao === 'baixo' ? 'table-danger' : receitaAnaliseSoloParametro.value.avaliacao === 'medio' ? 'table-warning' : receitaAnaliseSoloParametro.value.avaliacao === 'adequado' ? 'table-success' : ''">
                                    {{receitaAnaliseSoloParametro.value.avaliacao}}
                                </td>
                            </tr> -->
                        </ng-template>
                    </tbody>
                </table>
            </div>
            <div formGroupName="receitaAmostragemSolo">
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center">INFORME SE FOI REALIZADA AMOSTRAGEM DE SOLO DE 20-40 CM
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <mat-checkbox class="example-margin" formControlName="realizada"
                                    (change)="realizadaChange($event.source, $event.checked, frm.controls['receitaAmostragemSolo']['controls']['realizada'])">
                                    Sim
                                </mat-checkbox>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <table class="table m-4" *ngIf="frm?.value.receitaAmostragemSolo.realizada === 'S'">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center" colspan="3">SE A RESPOSTA ANTERIOR FOI SIM, INFORME OS
                                DADOS
                                ABAIXO
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                Cálcio - Ca
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="calcio">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                cmolс/dm³ = mE/100mL
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Alumínio - Al3
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="aluminio">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                cmolс/dm³ = mE/100mL
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Saturação por Alumínio - m
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="satAluminio">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                %
                            </td>
                        </tr>
                        <tr>
                            <small><b>Observações:</b> Os dados acima serão usados para cálculo do gesso
                                agrícola, o qual tem permitido a elevação de produtividade em inúmeros
                                cultivos, com destaque para hortaliças.</small>
                        </tr>
                    </tbody>
                </table>
            </div>


            <mat-accordion>
                <mat-expansion-panel>
                    <mat-expansion-panel-header style="background-color: black; color: white;">
                        <mat-panel-description style="background-color: black; color: white;">
                            INTERPRETAÇÃO DA ANALISE LABORATORIAL DE SOLOS
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <div class="table-responsive">
                        <table class="table m-4">
                            <tbody>
                                <tr>
                                    <th>
                                        <p *ngIf="true">Textura</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">pH em H2O</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">pH em CaCl2</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">argilosa</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">alto</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">-</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="exibeParametroSolo('fosforo_remanescente')">Fósforo, P-Rem</p>
                                    </th>
                                    <th>
                                        <p *ngIf="exibeParametroSolo('fosforo_mehlich')">Fósforo - P, Mehlich 1</p>
                                    </th>
                                    <th>
                                        <p *ngIf="exibeParametroSolo('fosforo_resina')">Fósforo, P-Resina</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="exibeParametroSolo('fosforo_remanescente')">muito bom</p>
                                    </td>
                                    <td>
                                        <p *ngIf="exibeParametroSolo('fosforo_mehlich')">-</p>
                                    </td>
                                    <td>
                                        <p *ngIf="exibeParametroSolo('fosforo_resina')">-</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Potássio - K</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Cálcio - Ca</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Magnésio - Mg</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">baixo</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">muito baixo</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">-</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Enxofre - S</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Boro - B</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Zinco - Zn</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">muito bom</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">médio</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">muito bom</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Cobre - Cu</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Manganês - Mn</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Ferro - Fe</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">muito bom</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">muito bom</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">baixo</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Matéria orgânica - MO</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Carbono - C</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">C.T.C ou T</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">médio</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">médio</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">baixo</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Acidez (H + Al)</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Acidez trocável - Al³</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Saturação por Bases</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">baixo</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">muito baixo</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">muito baixo</p>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                    </div>

                </mat-expansion-panel>

                <mat-expansion-panel>
                    <mat-expansion-panel-header style="background-color: black; color: white;">
                        <mat-panel-description style="background-color: black; color: white;">
                            RELAÇÃO ENTRE OS NUTRIENTES
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <div class="table-responsive">
                        <table class="table m-4">
                            <tbody>
                                <tr>
                                    <th>
                                        <p *ngIf="true">Cálcio na C.T.C</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Magnésio na C.T.C</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Potássio na C.T.C</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">3,55%</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">1,77%</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">3,55%</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Sódio na C.T.C</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Alumínio na C.T.C</p>
                                    </th>
                                    <th>
                                        <p *ngIf="exibeParametroSolo('fosforo_resina')">P-Resina / P total</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">2,48%</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">0,00%</p>
                                    </td>
                                    <td>
                                        <p *ngIf="exibeParametroSolo('fosforo_resina')">-</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="exibeParametroSolo('fosforo_resina')">P-Resina / S</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">P-Melich / P Total</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">P-Melish / S</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="exibeParametroSolo('fosforo_resina')">36,54</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">18,00%</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">17,31</p>
                                    </td>
                                </tr>

                                <tr>
                                    <th>
                                        <p *ngIf="true">Ca/K</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Ca/Mg</p>
                                    </th>
                                    <th>
                                        <p *ngIf="true">Mg/K</p>
                                    </th>
                                </tr>
                                <tr>
                                    <td>
                                        <p *ngIf="true">1,00</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">2,00</p>
                                    </td>
                                    <td>
                                        <p *ngIf="true">0,50</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </mat-expansion-panel>

                <mat-expansion-panel *ngIf="false">
                    <mat-expansion-panel-header style="background-color: black; color: white;">
                        <mat-panel-description style="background-color: black; color: white;">
                            OBSERVAÇÕES
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <div class="table-responsive">
                        <table class="table m-4">
                            <tbody>
                                <tr>
                                    <th>
                                        1. A interpretação dos resultados da analise de solos foi feita com base no
                                        livro 5ª
                                        Aproximação - Recomendações para o uso de corretivos e fertilizantes em Minas
                                        Gerais.
                                        Viçosa/MG, 1999.
                                    </th>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </mat-expansion-panel>
            </mat-accordion>

            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Próximo</button>
            </mat-action-row>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)" hideToggle formGroupName="espacamento">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 2
                </mat-panel-title>
                <mat-panel-description>
                    Espaçamento
                    <mat-icon>date_range</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>

            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center"
                            [attr.colspan]="frm?.value?.cultura?.espacamentoQuantidade > 1 ? 5: 3">DETALHE O ESPAÇAMENTO
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td [attr.colspan]="frm?.value?.cultura?.espacamentoQuantidade > 1 ? 5: 3">
                            <p>Espaçamento, quantidade de linhas:</p>
                            <mat-form-field>
                                <mat-select formControlName="quantidade">
                                    <mat-option
                                        *ngFor="let linha of arrayIntegerTamanho(frm?.value?.cultura?.espacamentoQuantidade)"
                                        [value]="linha">
                                        {{linha}} linha(s)
                                    </mat-option>
                                </mat-select>
                                <mat-error>Campo Obrigatório!</mat-error>
                            </mat-form-field>
                        </td>
                    </tr>
                    <tr *ngIf="frm?.value.espacamento.quantidade">
                        <td>
                            <mat-form-field>
                                <mat-label>Entre Plantas</mat-label>
                                <input matInput type="number" class="text-right" formControlName="a"
                                    [attr.min]="frm?.get('espacamento.a').errors?.min?.min" step="0.5">
                                <span matSuffix> metros </span>
                                <mat-error *ngIf="frm?.get('espacamento.a').errors?.required">Campo
                                    Obrigatório!
                                </mat-error>
                                <mat-error *ngIf="frm?.get('espacamento.a').errors?.min">
                                    Valor mínimo ({{frm?.get('espacamento.a').errors?.min.min}}) ultrapassado!
                                </mat-error>
                            </mat-form-field>
                        </td>
                        <td>X</td>
                        <td>
                            <mat-form-field>
                                <mat-label>Entre Ruas</mat-label>
                                <input matInput type="number" class="text-right" formControlName="b"
                                    [attr.min]="frm?.get('espacamento.b').errors?.min?.min" step="0.5">
                                <span matSuffix> metros </span>
                                <mat-error *ngIf="frm?.get('espacamento.b').errors?.required">Campo
                                    Obrigatório!
                                </mat-error>
                                <mat-error *ngIf="frm?.get('espacamento.b').errors?.min">
                                    Valor mínimo ({{frm?.get('espacamento.b').errors?.min.min}}) ultrapassado!
                                </mat-error>
                            </mat-form-field>
                        </td>
                        <td *ngIf="frm?.value.espacamento.quantidade > 1">X</td>
                        <td *ngIf="frm?.value.espacamento.quantidade > 1">
                            <p
                                *ngFor="let i of arrayIntegerTamanho((frm?.value.espacamento.quantidade ? frm?.value.espacamento.quantidade : 1) - 1)">
                                <mat-form-field>
                                    <mat-label>Entre Plantas {{i + 1}}&#170; linha</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="c"
                                        [attr.min]="frm?.get('espacamento.c').errors?.min?.min" step="0.5">
                                    <span matSuffix> metros </span>
                                    <mat-error *ngIf="frm?.get('espacamento.c').errors?.required">Campo
                                        Obrigatório!
                                    </mat-error>
                                    <mat-error *ngIf="frm?.get('espacamento.c').errors?.min">
                                        Valor mínimo ({{frm?.get('espacamento.c').errors?.min.min}}) ultrapassado!
                                    </mat-error>
                                </mat-form-field>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table m-4"
                *ngIf="frm?.value.espacamento?.a > 0 && frm?.value.espacamento?.b > 0 && (!frm?.value.espacamento?.quantidade || frm?.value.espacamento?.quantidade && frm?.value.espacamento?.c > 0)">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center">
                            NÚMERO DE PLANTAS
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <mat-form-field>
                                <mat-label>Quantidade de Plantas</mat-label>
                                <input matInput type="number" class="text-right" formControlName="quantidadePlanta"
                                    [attr.min]="frm?.get('espacamento.quantidadePlanta').errors?.min?.min" step="1">
                                <span matSuffix> unidades </span>
                                <mat-error *ngIf="frm?.get('espacamento.quantidadePlanta').errors?.required">Campo
                                    Obrigatório!
                                </mat-error>
                                <mat-error *ngIf="frm?.get('espacamento.quantidadePlanta').errors?.min">
                                    Valor mínimo ({{frm?.get('espacamento.quantidadePlanta').errors?.min.min}})
                                    ultrapassado!
                                </mat-error>
                            </mat-form-field>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table m-4"
                *ngIf="frm?.value.espacamento?.a > 0 && frm?.value.espacamento?.b > 0 && (!frm?.value.espacamento?.quantidade || frm?.value.espacamento?.quantidade && frm?.value.espacamento?.c > 0)">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center">
                            ÁREA
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <mat-form-field>
                                <mat-label>Tamanho</mat-label>
                                <input matInput type="number" class="text-right" formControlName="area"
                                    [attr.min]="frm?.get('espacamento.area').errors?.min?.min" step="1">
                                <span matSuffix> hectáres </span>
                                <mat-error *ngIf="frm?.get('espacamento.area').errors?.required">Campo
                                    Obrigatório!
                                </mat-error>
                                <mat-error *ngIf="frm?.get('espacamento.area').errors?.min">
                                    Valor mínimo ({{frm?.get('espacamento.area').errors?.min.min}}) ultrapassado!
                                </mat-error>
                            </mat-form-field>
                        </td>
                    </tr>
                </tbody>
            </table>
            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Próximo</button>
            </mat-action-row>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 3
                </mat-panel-title>
                <mat-panel-description>
                    Corretivos, remineralizadores e gesso agrícola
                    <mat-icon>date_range</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">ESCOLHA O CALCÁRIO QUE SERÁ USADO PARA CORREÇÃO
                            DE SOLO</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <mat-form-field>
                                <mat-select [compareWith]="idListComparar" #adubovlr formControlName="calcario"
                                    (selectionChange)="atualizaPessoaAduboPreco($event, frm.get('calcarioPrecoPorQuilo'))">
                                    <mat-option
                                        *ngFor="let adubo of aduboList | callback : filtraAduboTipo : ['calcario']"
                                        [value]="adubo">
                                        {{adubo.nome}}
                                    </mat-option>
                                </mat-select>
                                <mat-error>Campo Obrigatório!</mat-error>
                            </mat-form-field>
                            <!-- {{adubovlr.value | json}} -->
                        </td>
                        <td class="text-right">
                            <mat-form-field>
                                <mat-label>Preço por Quilo</mat-label>
                                <input matInput type="number" class="text-right" min="0" step="0.01"
                                    formControlName="calcarioPrecoPorQuilo" [readonly]="!frm.get('calcario').value">

                                <mat-error *ngIf="frm.get('calcarioPrecoPorQuilo').errors?.required">Campo
                                    Obrigatório!</mat-error>
                                <mat-error *ngIf="frm.get('calcarioPrecoPorQuilo').errors?.min">
                                    Valor mínimo
                                    ({{frm.get('calcarioPrecoPorQuilo').errors?.min.min}})
                                    ultrapassado!</mat-error>
                                <mat-error *ngIf="frm.get('calcarioPrecoPorQuilo').errors?.max">
                                    Valor máximo
                                    ({{frm.get('calcarioPrecoPorQuilo').errors?.max.max}})
                                    ultrapassado!</mat-error>
                            </mat-form-field>
                        </td>
                        <td>
                            <!-- X -->
                        </td>
                        <td>
                            <!-- <mat-slider thumbLabel min="0" max="100" step="0.5" #vlr1 [disabled]="!adubovlr.value"
                                formControlName="calcarioPercentual">
                            </mat-slider>
                            [{{vlr1.value | number:'3.1-1':'pt-BR' }}]% -->
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">

                            <small><b>Observações:</b> Você pode cadastrar outros insumos do seu interesse no menu
                                <a routerLink="../pessoa-adubo-preco">Meus Preços de Adubos</a> para que eles
                                apareçam na lista acima</small>

                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">CASO DESEJE SUBSTITUIR O CALCÁRIO POR
                            REMINERALIZADOR,
                            ESCOLHA O REMINERALIZADOR E INDIQUE O PERCENTUAL DE SUBSTITUIÇÃO
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <mat-form-field>
                                <mat-select [compareWith]="idListComparar" #poDeRochav formControlName="poDeRocha"
                                    (selectionChange)="atualizaPessoaAduboPreco($event, frm.get('poDeRochaPrecoPorQuilo'))">
                                    <mat-option
                                        *ngFor="let remineralizador of aduboList | callback : filtraAduboTipo : ['po_de_rocha']"
                                        [value]="remineralizador">
                                        {{remineralizador.nome}}
                                    </mat-option>
                                </mat-select>
                                <mat-error>Campo Obrigatório!</mat-error>
                            </mat-form-field>
                        </td>
                        <td class="text-right">
                            <mat-form-field>
                                <mat-label>Preço por Quilo</mat-label>
                                <input matInput type="number" class="text-right" min="0" step="0.01"
                                    formControlName="poDeRochaPrecoPorQuilo" [readonly]="!frm.get('poDeRocha').value">
                                <mat-error *ngIf="frm.get('poDeRochaPrecoPorQuilo').errors?.required">Campo
                                    Obrigatório!</mat-error>
                                <mat-error *ngIf="frm.get('poDeRochaPrecoPorQuilo').errors?.min">
                                    Valor mínimo
                                    ({{frm.get('poDeRochaPrecoPorQuilo').errors?.min.min}})
                                    ultrapassado!</mat-error>
                                <mat-error *ngIf="frm.get('poDeRochaPrecoPorQuilo').errors?.max">
                                    Valor máximo
                                    ({{frm.get('poDeRochaPrecoPorQuilo').errors?.max.max}})
                                    ultrapassado!</mat-error>
                            </mat-form-field>
                        </td>
                        <td>X</td>
                        <td>
                            <!-- <mat-slider thumbLabel min="0" max="100" step="0.5" #vlr2 [disabled]="!poDeRochav.value"
                                formControlName="poDeRochaPercentual">
                            </mat-slider>
                            [{{vlr2.value | number:'3.1-1':'pt-BR' }}]%
                             -->
                            <mat-form-field>
                                <mat-label>Percentual</mat-label>
                                <input matInput type="number" class="text-right" min="0" step="0.01"
                                    formControlName="poDeRochaPercentual" [disabled]="!poDeRochav.value">

                                <mat-error *ngIf="frm.get('poDeRochaPercentual').errors?.required">Campo
                                    Obrigatório!</mat-error>
                                <mat-error *ngIf="frm.get('poDeRochaPercentual').errors?.min">
                                    Valor mínimo
                                    ({{frm.get('poDeRochaPercentual').errors?.min.min}})
                                    ultrapassado!</mat-error>
                                <mat-error *ngIf="frm.get('poDeRochaPercentual').errors?.max">
                                    Valor máximo
                                    ({{frm.get('poDeRochaPercentual').errors?.max.max}})
                                    ultrapassado!</mat-error>
                            </mat-form-field> %
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4">
                            <small><b>Observações:</b> O uso de resíduos industriais
                                de pedreiras tem permitido o aumento da saúde dos solos e produtividade
                                das hortaliças, desde que pelo menos 80% das suas particulas
                                sejam menores de 0,3 milímetros.</small>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Necessidade de Calcário:
                        </td>
                        <td colspan="3">
                            [{{frm?.value.necessidadeCalcarioCorrigido}}]
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Necessidade de Remineralizador:
                        </td>
                        <td colspan="3">
                            [{{frm?.value.necessidadePoDeRochaCorrigido}}]
                        </td>
                    </tr>
                </tbody>
            </table>

            <!--
            <mat-card>
                <mat-card-content>
                    <div class="alert"
                        [class]="(vlr1?.value + vlr2?.value) < 100 ? 'alert-warning' : (vlr1?.value + vlr2?.value) === 100 ? 'alert-success' : 'alert-danger'">
                        <h2 class="m-2">
                            Percentual Total [{{vlr1?.value | number:'3.1-1':'pt-BR'}}% +
                            {{vlr2?.value | number:'3.1-1':'pt-BR'}}]% =
                            {{(vlr1?.value + vlr2.value) | number:'3.1-1':'pt-BR'}}%
                        </h2>
                        <small *ngIf="(vlr1?.value + vlr2?.value) < 100">Acrescente os Percentuais</small>
                        <small *ngIf="(vlr1?.value + vlr2?.value) === 100">Percentual Válido</small>
                        <small *ngIf="(vlr1?.value + vlr2?.value) > 100">Dimunua os Percentuais</small>
                        <section>
                            <mat-progress-bar color="primary" mode="determinate"
                                [value]="(vlr1?.value / 1) + (vlr2?.value / 1)" #barra>
                            </mat-progress-bar>
                        </section>
                    </div>
                </mat-card-content>
            </mat-card>
            -->
            <div formGroupName="receitaAmostragemSolo" *ngIf="frm?.value.receitaAmostragemSolo.realizada === 'S'">
                <table class="table m-4">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" class="text-center" colspan="2">ESCOLHA O GESSO AGRÍCOLA</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="0">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="gesso"
                                        (selectionChange)="atualizaPessoaAduboPreco($event, frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'])">
                                        <mat-option
                                            *ngFor="let gesso of aduboList | callback : filtraAduboTipo : ['gesso_agricola']"
                                            [value]="gesso">
                                            {{gesso.nome}}</mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td class="text-right">
                                <mat-form-field>
                                    <mat-label>Preço por Quilo</mat-label>
                                    <input matInput type="number" class="text-right" min="0" step="0.01"
                                        formControlName="precoPorQuilo"
                                        [readonly]="!frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'].value">

                                    <mat-error
                                        *ngIf="frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'].errors?.required">
                                        Campo
                                        Obrigatório!</mat-error>
                                    <mat-error
                                        *ngIf="frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'].errors?.min">
                                        Valor mínimo
                                        ({{frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'].errors?.min.min}})
                                        ultrapassado!</mat-error>
                                    <mat-error
                                        *ngIf="frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'].errors?.max">
                                        Valor máximo
                                        ({{frm.get('receitaAmostragemSolo')['controls']['precoPorQuilo'].errors?.max.max}})
                                        ultrapassado!</mat-error>
                                </mat-form-field>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <small><b>Observações:</b> Nas camadas mais profundas
                                    do solo, o uso de gesso agrícola diminui a toxidez de alumínio,
                                    fornece cálcio e enxofre e permite o aumento do sistema
                                    radicular das plantas.</small>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Necessidade de gesso:
                            </td>
                            <td>
                                [{{frm?.value.necessidadeDeGesso}}]
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <table class="table table-striped m-4">
                <thead class="thead-dark text-center">
                    <tr>
                        <th colspan="3">TOTAIS / CUSTOS</th>
                    </tr>
                    <tr>
                        <th>Elemento</th>
                        <th>Custo por [{{frm.get('formaPlantio').value}}] (R$)</th>
                        <th>Custo por área plantada (R$)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Calcário</td>
                        <td class="text-right">0,00</td>
                        <td class="text-right">0,00</td>
                    </tr>
                    <tr>
                        <td>Remineralizador</td>
                        <td class="text-right">0,00</td>
                        <td class="text-right">0,00</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Totais</th>
                        <th class="text-right">0,00</th>
                        <th class="text-right">0,00</th>
                    </tr>
                </tfoot>
            </table>

            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Próximo</button>
            </mat-action-row>
        </mat-expansion-panel>


        <!-- PAREI AQUI, MAS O JULIANO PEDIU PARA DESCOMENTAR 20/06/2021 -->
        <mat-expansion-panel [expanded]="step === 3" (opened)="setStep(3)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 4
                </mat-panel-title>
                <mat-panel-description>
                    Adubo
                    <mat-icon>date_range</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>

            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">
                            ESCOLHA A FONTE DO ADUBO ORGÂNICO PARA ADUBAÇÃO DE BASE / PLANTIO
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFonteMateriaOrganicaList">
                    <ng-template ngFor let-receitaFonteMateriaOrganica
                        [ngForOf]="frm?.get('receitaFonteMateriaOrganicaList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                {{receitaFonteMateriaOrganica.value.adubo.nome}}
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo"
                                        (selectionChange)="atualizaPessoaAduboPreco($event, frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('precoPorQuilo'))">
                                        <mat-option
                                            *ngFor="let fonteMateriaOrganica of fonteMateriaOrganicaList | callback : filtraFonteMateriaOrganica : [frm] "
                                            [value]="fonteMateriaOrganica">
                                            {{fonteMateriaOrganica.nome}}</mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-label *ngIf="receitaFonteMateriaOrganica?.value.adubo?.quantidadeQuiloCova">
                                    Quantidade por Cova:
                                    {{receitaFonteMateriaOrganica?.value.adubo?.quantidadeQuiloCova}}
                                    kilos
                                </mat-label>
                            </td>
                            <!-- 
                            <td class="text-right">
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider formControlName="valor"></mat-slider>
                                % 
                            </td>
                            -->
                            <td class="text-right">
                                <mat-form-field>
                                    <mat-label>Preço por Quilo</mat-label>
                                    <input matInput type="number" class="text-right" min="0" step="0.01"
                                        formControlName="precoPorQuilo"
                                        [readonly]="!frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('adubo').value">
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('precoPorQuilo').errors?.required">
                                        Campo
                                        Obrigatório!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('precoPorQuilo').errors?.min">
                                        Valor mínimo
                                        ({{frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('precoPorQuilo').errors?.min.min}})
                                        ultrapassado!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('precoPorQuilo').errors?.max">
                                        Valor máximo
                                        ({{frm?.get('receitaFonteMateriaOrganicaList')['controls'][i].get('precoPorQuilo').errors?.max.max}})
                                        ultrapassado!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFonteMateriaOrganica(i)"
                                    *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr *ngIf="(fonteMateriaOrganicaList | callback : filtraFonteMateriaOrganica : [frm])?.length > 1">
                        <td colspan="5" *ngIf="false">
                            <button mat-button color="warn" (click)="inserirFonteMateriaOrganica()"
                                [disabled]="frm?.get('receitaFonteMateriaOrganicaList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <!-- <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFonteMateriaOrganicaPercTotal < 100 ? 'table-danger' : frm?.value.receitaFonteMateriaOrganicaPercTotal > 100 ? 'table-warning' : frm?.value.receitaFonteMateriaOrganicaPercTotal === 100 ? 'table-success' : ''">
                        <td colspan="4">Total Geral Percentual</td>
                        <td>
                            {{frm?.value.receitaFonteMateriaOrganicaPercTotal}}%
                        </td>
                    </tr>
                </tfoot> -->
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->

            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">
                            ESCOLHA O ADUBO DE BASE / PLANTIO
                            <!-- FRZ -->
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFonteNitrogenioList">
                    <ng-template ngFor let-receitaFonteNitrogenio
                        [ngForOf]="frm?.get('receitaFonteNitrogenioList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                <p>{{receitaFonteNitrogenio.value.adubo.nome}}</p>
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo"
                                        (selectionChange)="atualizaPessoaAduboPreco($event, frm?.get('receitaFonteNitrogenioList')['controls'][i].get('precoPorQuilo'))">
                                        <mat-option
                                            *ngFor="let fonteNitrogenio of fonteNitrogenioList | callback : filtraFonteAdubo : [frm, 'receitaFonteNitrogenioList']"
                                            [value]="fonteNitrogenio">
                                            {{fonteNitrogenio.nome}}</mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field *ngIf="false">
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider *ngIf="false" formControlName="valor"></mat-slider>
                                <span *ngIf="false">%</span>
                            </td>
                            <td>
                                <div *ngIf="receitaFonteNitrogenio.value.adubo?.id" style="font-size: 70%;">
                                    <p>
                                        Nitrogênio:
                                        {{receitaFonteNitrogenio.value.totalNitrogenio *
                                        (receitaFonteNitrogenio.value.valor / 100)}}
                                        de {{receitaFonteNitrogenio.value.totalNitrogenio}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Fósforo:
                                        {{receitaFonteNitrogenio.value.totalFosforo *
                                        (receitaFonteNitrogenio.value.valor / 100)}}
                                        de {{receitaFonteNitrogenio.value.totalFosforo}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Potássio:
                                        {{receitaFonteNitrogenio.value.totalPotassio *
                                        (receitaFonteNitrogenio.value.valor / 100)}}
                                        de {{receitaFonteNitrogenio.value.totalPotassio}}
                                        (g/planta)
                                    </p>
                                </div>
                            </td>
                            <td class="text-right">
                                <mat-form-field>
                                    <mat-label>Preço por Quilo</mat-label>
                                    <input matInput type="number" class="text-right" min="0" step="0.01"
                                        formControlName="precoPorQuilo"
                                        [readonly]="!frm?.get('receitaFonteNitrogenioList')['controls'][i].get('adubo').value">
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteNitrogenioList')['controls'][i].get('precoPorQuilo').errors?.required">
                                        Campo
                                        Obrigatório!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteNitrogenioList')['controls'][i].get('precoPorQuilo').errors?.min">
                                        Valor mínimo
                                        ({{frm?.get('receitaFonteNitrogenioList')['controls'][i].get('precoPorQuilo').errors?.min.min}})
                                        ultrapassado!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteNitrogenioList')['controls'][i].get('precoPorQuilo').errors?.max">
                                        Valor máximo
                                        ({{frm?.get('receitaFonteNitrogenioList')['controls'][i].get('precoPorQuilo').errors?.max.max}})
                                        ultrapassado!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFonteNitrogenio(i)"
                                    *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr
                        *ngIf="(fonteNitrogenioList | callback : filtraFonteAdubo : [frm, 'receitaFonteNitrogenioList'])?.length > 1">
                        <td colspan="6">
                            <button mat-button color="warn" (click)="inserirFonteNitrogenio()"
                                [disabled]="frm?.get('receitaFonteNitrogenioList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFonteNitrogenioPercTotal < 100 ? 'table-danger' : frm?.value.receitaFonteNitrogenioPercTotal > 100 ? 'table-warning' : frm?.value.receitaFonteNitrogenioPercTotal === 100 ? 'table-success' : ''">
                        <td colspan="4">Total Geral Percentual</td>
                        <td colspan="2">
                            {{frm?.value.receitaFonteNitrogenioPercTotal}}%
                        </td>
                    </tr>
                </tfoot>
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->

            <table class="table m-4" *ngIf="false">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">
                            ESCOLHA O ADUBO FONTE DE FÓSFORO E INFORME O PERCENTUAL QUE CABERÁ A CADA ADUBO
                            <!-- FRZ -->
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFonteFosforoList">
                    <ng-template ngFor let-receitaFonteFosforo
                        [ngForOf]="frm?.get('receitaFonteFosforoList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                {{receitaFonteFosforo.value.adubo.nome}}
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo">
                                        <mat-option
                                            *ngFor="let fonteFosforo of fonteFosforoList | callback : filtraFonteAdubo : [frm, 'receitaFonteFosforoList']"
                                            [value]="fonteFosforo">
                                            {{fonteFosforo.nome}}</mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider formControlName="valor"></mat-slider>
                                %
                            </td>
                            <td>
                                <div *ngIf="receitaFonteFosforo.value.adubo?.id" style="font-size: 70%;">
                                    <p>
                                        Nitrogênio:
                                        {{receitaFonteFosforo.value.totalNitrogenio * (receitaFonteFosforo.value.valor /
                                        100)}}
                                        de {{receitaFonteFosforo.value.totalNitrogenio}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Fósforo:
                                        {{receitaFonteFosforo.value.totalFosforo * (receitaFonteFosforo.value.valor /
                                        100)}}
                                        de {{receitaFonteFosforo.value.totalFosforo}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Potássio:
                                        {{receitaFonteFosforo.value.totalPotassio * (receitaFonteFosforo.value.valor /
                                        100)}}
                                        de {{receitaFonteFosforo.value.totalPotassio}}
                                        (g/planta)
                                    </p>
                                </div>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFonteFosforo(i)" *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr
                        *ngIf="(fonteFosforoList | callback : filtraFonteAdubo : [frm, 'receitaFonteFosforoList'])?.length > 1">
                        <td colspan="5">
                            <button mat-button color="warn" (click)="inserirFonteFosforo()"
                                [disabled]="frm?.get('receitaFonteFosforoList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFonteFosforoPercTotal < 100 ? 'table-danger' : frm?.value.receitaFonteFosforoPercTotal > 100 ? 'table-warning' : frm?.value.receitaFonteFosforoPercTotal === 100 ? 'table-success' : ''">
                        <td colspan="3">Total Geral Percentual</td>
                        <td colspan="2">
                            {{frm?.value.receitaFonteFosforoPercTotal}}%
                        </td>
                    </tr>
                </tfoot>
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->

            <table class="table m-4" *ngIf="false">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">
                            ESCOLHA O ADUBO FONTE DE POTÁSSIO E INFORME O PERCENTUAL QUE CABERÁ A CADA ADUBO
                            <!-- FRZ -->
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFontePotassioList">
                    <ng-template ngFor let-receitaFontePotassio
                        [ngForOf]="frm?.get('receitaFontePotassioList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                {{receitaFontePotassio.value.adubo.nome}}
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo">
                                        <mat-option
                                            *ngFor="let fontePotassio of fontePotassioList | callback : filtraFonteAdubo : [frm, 'receitaFontePotassioList']"
                                            [value]="fontePotassio">
                                            {{fontePotassio.nome}}</mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider formControlName="valor"></mat-slider>
                                %
                            </td>
                            <td>
                                <div *ngIf="receitaFontePotassio.value.adubo?.id" style="font-size: 70%;">
                                    <p>
                                        Nitrogênio:
                                        {{receitaFontePotassio.value.totalNitrogenio * (receitaFontePotassio.value.valor
                                        / 100)}}
                                        de {{receitaFontePotassio.value.totalNitrogenio}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Fósforo:
                                        {{receitaFontePotassio.value.totalFosforo * (receitaFontePotassio.value.valor /
                                        100)}}
                                        de {{receitaFontePotassio.value.totalFosforo}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Potássio:
                                        {{receitaFontePotassio.value.totalPotassio * (receitaFontePotassio.value.valor /
                                        100)}}
                                        de {{receitaFontePotassio.value.totalPotassio}}
                                        (g/planta)
                                    </p>
                                </div>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFontePotassio(i)" *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr
                        *ngIf="(fontePotassioList | callback : filtraFonteAdubo : [frm, 'receitaFontePotassioList'])?.length > 1">
                        <td colspan="5">
                            <button mat-button color="warn" (click)="inserirFontePotassio()"
                                [disabled]="frm?.get('receitaFontePotassioList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFontePotassioPercTotal < 100 ? 'table-danger' : frm?.value.receitaFontePotassioPercTotal > 100 ? 'table-warning' : frm?.value.receitaFontePotassioPercTotal === 100 ? 'table-success' : ''">
                        <td colspan="4">Total Geral Percentual</td>
                        <td colspan="1">
                            {{frm?.value.receitaFontePotassioPercTotal}}%
                        </td>
                    </tr>
                </tfoot>
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->

            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th><label>ESCOLHA A FORMA DE IRRIGAÇÃO</label></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <mat-radio-group style="display: flex; flex-direction: column; margin: 15px 0; "
                                formControlName="formaIrrigacao">
                                <mat-radio-button style="margin: 5px;" *ngFor="let item of formaIrrigacaoList"
                                    [value]="item">
                                    {{item.nome}}
                                </mat-radio-button>
                            </mat-radio-group>
                            <!-- {{frm?.value.formaIrrigacao | json}} -->
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th><label>ESCOLHA A FORMA DE APLICAÇÃO DOS ADUBOS</label></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <mat-radio-group style="display: flex; flex-direction: column; margin: 15px 0; "
                                formControlName="formaAplicacaoAdubo">
                                <mat-radio-button style="margin: 5px;" *ngFor="let item of formaAplicacaoAduboList"
                                    [value]="item">
                                    {{item.nome}}
                                </mat-radio-button>
                            </mat-radio-group>
                            <!-- {{frm?.value.formaAplicacaoAdubo | json}} -->
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="table m-4" *ngIf="frm?.value.formaAplicacaoAdubo?.codigo === 'cobertura'">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="5">
                            ESCOLHA O ADUBO FONTE DE COBERTURA
                            <!-- FRZ -->
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFonteCoberturaList">
                    <ng-template ngFor let-receitaFonteCobertura
                        [ngForOf]="frm?.get('receitaFonteCoberturaList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                {{receitaFonteCobertura.value.adubo.nome}}
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo"
                                        (selectionChange)="atualizaPessoaAduboPreco($event, frm?.get('receitaFonteCoberturaList')['controls'][i].get('precoPorQuilo'))">
                                        <mat-option
                                            *ngFor="let fonteCobertura of fonteCoberturaList | callback : filtraFonteCobertura : [frm] "
                                            [value]="fonteCobertura">
                                            {{fonteCobertura.nome}}
                                        </mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider formControlName="valor"></mat-slider>
                                %
                            </td>
                            <td>
                                <div *ngIf="receitaFonteCobertura.value.adubo?.id" style="font-size: 70%;">
                                    <p>
                                        Boro:
                                        {{receitaFonteCobertura.value.totalBoro *
                                        (receitaFonteCobertura.value.valor / 100)}}
                                        de {{receitaFonteCobertura.value.totalBoro}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Cobre:
                                        {{receitaFonteCobertura.value.totalCobre *
                                        (receitaFonteCobertura.value.valor / 100)}}
                                        de {{receitaFonteCobertura.value.totalCobre}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Manganês:
                                        {{receitaFonteCobertura.value.totalManganes *
                                        (receitaFonteCobertura.value.valor / 100)}}
                                        de {{receitaFonteCobertura.value.totalManganes}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Zinco:
                                        {{receitaFonteCobertura.value.totalZinco *
                                        (receitaFonteCobertura.value.valor / 100)}}
                                        de {{receitaFonteCobertura.value.totalZinco}}
                                        (g/planta)
                                    </p>
                                </div>
                            </td>
                            <td class="text-right">
                                <mat-form-field>
                                    <mat-label>Preço por Quilo</mat-label>
                                    <input matInput type="number" class="text-right" min="0" step="0.01"
                                        formControlName="precoPorQuilo"
                                        [readonly]="!frm?.get('receitaFonteCoberturaList')['controls'][i].get('adubo').value">
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteCoberturaList')['controls'][i].get('precoPorQuilo').errors?.required">
                                        Campo
                                        Obrigatório!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteCoberturaList')['controls'][i].get('precoPorQuilo').errors?.min">
                                        Valor mínimo
                                        ({{frm?.get('receitaFonteCoberturaList')['controls'][i].get('precoPorQuilo').errors?.min.min}})
                                        ultrapassado!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteCoberturaList')['controls'][i].get('precoPorQuilo').errors?.max">
                                        Valor máximo
                                        ({{frm?.get('receitaFonteCoberturaList')['controls'][i].get('precoPorQuilo').errors?.max.max}})
                                        ultrapassado!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFonteCobertura(i)" *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr *ngIf="(fonteCoberturaList | callback : filtraFonteCobertura : [frm])?.length > 1">
                        <td colspan="6">
                            <button mat-button color="warn" (click)="inserirFonteCobertura()"
                                [disabled]="frm?.get('receitaFonteCoberturaList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFonteCoberturaPercTotal < 100 ? 'table-danger' : frm?.value.receitaFonteCoberturaPercTotal > 100 ? 'table-warning' : frm?.value.receitaFonteCoberturaPercTotal === 100 ? 'table-success' : ''">
                        <td colspan="5">Total Geral Percentual</td>
                        <td>
                            {{frm?.value.receitaFonteCoberturaPercTotal}}%
                        </td>
                    </tr>
                </tfoot>
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->

            <table class="table m-4" *ngIf="frm?.value.formaAplicacaoAdubo?.codigo === 'fertirrigacao'">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="5">
                            ESCOLHA O ADUBO FONTE DE FERTIRRIGACAO
                            <!-- FRZ -->
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFonteFertirrigacaoList">
                    <ng-template ngFor let-receitaFonteFertirrigacao
                        [ngForOf]="frm?.get('receitaFonteFertirrigacaoList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                {{receitaFonteFertirrigacao.value.adubo.nome}}
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo"
                                        (selectionChange)="atualizaPessoaAduboPreco($event, frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('precoPorQuilo'))">
                                        <mat-option
                                            *ngFor="let fonteFertirrigacao of fonteFertirrigacaoList | callback : filtraFonteFertirrigacao : [frm] "
                                            [value]="fonteFertirrigacao">
                                            {{fonteFertirrigacao.nome}}
                                        </mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider formControlName="valor"></mat-slider>
                                %
                            </td>
                            <td>
                                <div *ngIf="receitaFonteFertirrigacao.value.adubo?.id" style="font-size: 70%;">
                                    <p>
                                        Boro:
                                        {{receitaFonteFertirrigacao.value.totalBoro *
                                        (receitaFonteFertirrigacao.value.valor / 100)}}
                                        de {{receitaFonteFertirrigacao.value.totalBoro}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Cobre:
                                        {{receitaFonteFertirrigacao.value.totalCobre *
                                        (receitaFonteFertirrigacao.value.valor / 100)}}
                                        de {{receitaFonteFertirrigacao.value.totalCobre}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Manganês:
                                        {{receitaFonteFertirrigacao.value.totalManganes *
                                        (receitaFonteFertirrigacao.value.valor / 100)}}
                                        de {{receitaFonteFertirrigacao.value.totalManganes}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Zinco:
                                        {{receitaFonteFertirrigacao.value.totalZinco *
                                        (receitaFonteFertirrigacao.value.valor / 100)}}
                                        de {{receitaFonteFertirrigacao.value.totalZinco}}
                                        (g/planta)
                                    </p>
                                </div>
                            </td>
                            <td class="text-right">
                                <mat-form-field>
                                    <mat-label>Preço por Quilo</mat-label>
                                    <input matInput type="number" class="text-right" min="0" step="0.01"
                                        formControlName="precoPorQuilo"
                                        [readonly]="!frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('adubo').value">
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('precoPorQuilo').errors?.required">
                                        Campo
                                        Obrigatório!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('precoPorQuilo').errors?.min">
                                        Valor mínimo
                                        ({{frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('precoPorQuilo').errors?.min.min}})
                                        ultrapassado!</mat-error>
                                    <mat-error
                                        *ngIf="frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('precoPorQuilo').errors?.max">
                                        Valor máximo
                                        ({{frm?.get('receitaFonteFertirrigacaoList')['controls'][i].get('precoPorQuilo').errors?.max.max}})
                                        ultrapassado!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFonteFertirrigacao(i)" *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr *ngIf="(fonteFertirrigacaoList | callback : filtraFonteFertirrigacao : [frm])?.length > 1">
                        <td colspan="6">
                            <button mat-button color="warn" (click)="inserirFonteFertirrigacao()"
                                [disabled]="frm?.get('receitaFonteFertirrigacaoList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFonteFertirrigacaoPercTotal < 100 ? 'table-danger' : frm?.value.receitaFonteFertirrigacaoPercTotal > 100 ? 'table-warning' : frm?.value.receitaFonteFertirrigacaoPercTotal === 100 ? 'table-success' : ''">
                        <td colspan="5">Total Geral Percentual</td>
                        <td>
                            {{frm?.value.receitaFonteFertirrigacaoPercTotal}}%
                        </td>
                    </tr>
                </tfoot>
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->


            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th>Nutrientes</th>
                        <th>N</th>
                        <th>P2O5</th>
                        <th>K2O</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngIf="false">
                        <td>Demanda (g/planta)</td>
                        <td>{{frm?.value.eficienciaDeNitrogenio}}</td>
                        <td>{{frm?.value.eficienciaDeFosforo}}</td>
                        <td>{{frm?.value.eficienciaDePotassio}}</td>
                    </tr>
                    <tr>
                        <td>Excesso/déficit (g/planta)</td>
                        <td
                            [ngClass]="frm?.value.eficienciaDeNitrogenio / (frm?.value.totalExcessoDeficitNitrogenio / 100) < 0 ? 'table-danger' : frm?.value.eficienciaDeNitrogenio / (frm?.value.totalExcessoDeficitNitrogenio / 100) > 0 ? 'table-warning' : frm?.value.eficienciaDeNitrogenio / (frm?.value.totalExcessoDeficitNitrogenio / 100) === 0 ? 'table-success' : ''">
                            {{(frm?.value.eficienciaDeNitrogenio / (frm?.value.totalExcessoDeficitNitrogenio / 100) |
                            number:'1.2-2':'pt-BR')}}
                        </td>
                        <td
                            [ngClass]="frm?.value.eficienciaDeFosforo / (frm?.value.totalExcessoDeficitFosforo / 100) < 0 ? 'table-danger' : frm?.value.eficienciaDeFosforo / (frm?.value.totalExcessoDeficitFosforo / 100) > 0 ? 'table-warning' : frm?.value.eficienciaDeFosforo / (frm?.value.totalExcessoDeficitFosforo / 100) === 0 ? 'table-success' : ''">
                            {{(frm?.value.eficienciaDeFosforo / (frm?.value.totalExcessoDeficitFosforo / 100) |
                            number:'1.2-2':'pt-BR')}}
                        </td>
                        <td
                            [ngClass]="frm?.value.eficienciaDePotassio / (frm?.value.totalExcessoDeficitPotassio / 100) < 0 ? 'table-danger' : frm?.value.eficienciaDePotassio / (frm?.value.totalExcessoDeficitPotassio / 100) > 0 ? 'table-warning' : frm?.value.eficienciaDePotassio / (frm?.value.totalExcessoDeficitPotassio / 100) === 0 ? 'table-success' : ''">
                            {{(frm?.value.eficienciaDePotassio / (frm?.value.totalExcessoDeficitPotassio / 100) |
                            number:'1.2-2':'pt-BR')}}
                        </td>
                    </tr>
                    <tr style="font-family: 'Courier New', Courier, monospace;">
                        <td colspan="1" style="text-align: right;">Legenda</td>
                        <td colspan="3">
                            <table>
                                <tr>
                                    <td class="table-danger" style="margin: 0px; padding: 0px;">
                                        Em falta
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table-warning" style="margin: 0px; padding: 0px;">
                                        Em excesso
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table-success" style="margin: 0px; padding: 0px;">
                                        Ok
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="table table-striped m-4">
                <thead class="thead-dark text-center">
                    <tr>
                        <th colspan="3">TOTAIS / CUSTOS</th>
                    </tr>
                    <tr>
                        <th>Elemento</th>
                        <th>Custo por [{{frm.get('formaPlantio').value}}] (R$)</th>
                        <th>Custo por área plantada (R$)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Adubo Orgânico</td>
                        <td class="text-right">0,00</td>
                        <td class="text-right">0,00</td>
                    </tr>
                    <tr>
                        <td>Adubo de Base</td>
                        <td class="text-right">0,00</td>
                        <td class="text-right">0,00</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Totais</th>
                        <th class="text-right">0,00</th>
                        <th class="text-right">0,00</th>
                    </tr>
                </tfoot>
            </table>

            <table class="table m-4">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col" class="text-center" colspan="4">
                            ESCOLHA O ADUBO FONTE DE MICRONUTRIENTE
                            <!-- FRZ -->
                        </th>
                    </tr>
                </thead>
                <tbody formArrayName="receitaFonteMicroNutrienteList">
                    <ng-template ngFor let-receitaFonteMicroNutriente
                        [ngForOf]="frm?.get('receitaFonteMicroNutrienteList')['controls']" let-i="index" let-f="first"
                        let-l="last">
                        <tr [formGroupName]="i">
                            <td *ngIf="!l">
                                {{receitaFonteMicroNutriente.value.adubo.nome}}
                            </td>
                            <td *ngIf="l">
                                <mat-form-field>
                                    <mat-select [compareWith]="idListComparar" formControlName="adubo">
                                        <mat-option
                                            *ngFor="let fonteMicroNutriente of fonteMicroNutrienteList | callback : filtraFonteMicroNutriente : [frm] "
                                            [value]="fonteMicroNutriente">
                                            {{fonteMicroNutriente.nome}}</mat-option>
                                    </mat-select>
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field>
                                    <mat-label>Valor</mat-label>
                                    <input matInput type="number" class="text-right" formControlName="valor" step="1"
                                        min="0" max="100">
                                    <mat-error>Campo Obrigatório!</mat-error>
                                </mat-form-field>
                                <mat-slider formControlName="valor"></mat-slider>
                                %
                            </td>
                            <td>
                                <div *ngIf="receitaFonteMicroNutriente.value.adubo?.id" style="font-size: 70%;">
                                    <p>
                                        Boro:
                                        {{receitaFonteMicroNutriente.value.totalBoro *
                                        (receitaFonteMicroNutriente.value.valor / 100)}}
                                        de {{receitaFonteMicroNutriente.value.totalBoro}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Cobre:
                                        {{receitaFonteMicroNutriente.value.totalCobre *
                                        (receitaFonteMicroNutriente.value.valor / 100)}}
                                        de {{receitaFonteMicroNutriente.value.totalCobre}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Manganês:
                                        {{receitaFonteMicroNutriente.value.totalManganes *
                                        (receitaFonteMicroNutriente.value.valor / 100)}}
                                        de {{receitaFonteMicroNutriente.value.totalManganes}}
                                        (g/planta)
                                    </p>
                                    <p>
                                        Zinco:
                                        {{receitaFonteMicroNutriente.value.totalZinco *
                                        (receitaFonteMicroNutriente.value.valor / 100)}}
                                        de {{receitaFonteMicroNutriente.value.totalZinco}}
                                        (g/planta)
                                    </p>
                                </div>
                            </td>
                            <td>
                                <button mat-button color="warn" (click)="excluirFonteMicroNutriente(i)" *ngIf="!f && l">
                                    Excluir
                                </button>
                            </td>
                        </tr>
                    </ng-template>
                    <tr *ngIf="(fonteMicroNutrienteList | callback : filtraFonteMicroNutriente : [frm])?.length > 1">
                        <td colspan="5">
                            <button mat-button color="warn" (click)="inserirFonteMicroNutriente()"
                                [disabled]="frm?.get('receitaFonteMicroNutrienteList').invalid">
                                Incluir
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr
                        [ngClass]="frm?.value.receitaFonteMicroNutrientePercTotal < 100 ? 'table-danger' : frm?.value.receitaFonteMicroNutrientePercTotal > 100 ? 'table-warning' : frm?.value.receitaFonteMicroNutrientePercTotal === 100 ? 'table-success' : ''">
                        <td colspan="4">Total Geral Percentual</td>
                        <td>
                            {{frm?.value.receitaFonteMicroNutrientePercTotal}}%
                        </td>
                    </tr>
                </tfoot>
            </table>
            <!-- <p>Observação: os valores acima não podem ser menores ou maiores que 100%</p> -->

            <table class="table">
                <thead class="thead-dark">
                    <tr>
                        <th>Nutrientes</th>
                        <th>Boro</th>
                        <th>Cobre</th>
                        <th>Manganês</th>
                        <th>Zinco</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngIf="false">
                        <td>Demanda (g/planta)</td>
                        <td>{{frm?.value.necessidadeDeBoro}}</td>
                        <td>{{frm?.value.necessidadeDeCobre}}</td>
                        <td>{{frm?.value.necessidadeDeManganes}}</td>
                        <td>{{frm?.value.necessidadeDeZinco}}</td>
                    </tr>
                    <tr>
                        <td>Excesso ou déficit (g/planta)</td>
                        <td
                            [ngClass]="(frm?.value.necessidadeDeBoro - frm?.value.totalExcessoDeficitBoro) * -1 < 0 ? 'table-danger' : (frm?.value.necessidadeDeBoro - frm?.value.totalExcessoDeficitBoro) * -1 >= 0 ? 'table-success' : ''">
                            {{(frm?.value.necessidadeDeBoro - frm?.value.totalExcessoDeficitBoro) * -1}}
                        </td>
                        <td
                            [ngClass]="(frm?.value.necessidadeDeCobre - frm?.value.totalExcessoDeficitCobre) * -1 < 0 ? 'table-danger' : (frm?.value.necessidadeDeCobre - frm?.value.totalExcessoDeficitCobre) * -1 > 0 ? 'table-warning' : (frm?.value.necessidadeDeCobre - frm?.value.totalExcessoDeficitCobre) * -1 === 0 ? 'table-success' : ''">
                            {{(frm?.value.necessidadeDeCobre - frm?.value.totalExcessoDeficitCobre) * -1}}
                        </td>
                        <td
                            [ngClass]="(frm?.value.necessidadeDeManganes - frm?.value.totalExcessoDeficitManganes) * -1 < 0 ? 'table-danger' : (frm?.value.necessidadeDeManganes - frm?.value.totalExcessoDeficitManganes) * -1 > 0 ? 'table-warning' : (frm?.value.necessidadeDeManganes - frm?.value.totalExcessoDeficitManganes) * -1 === 0 ? 'table-success' : ''">
                            {{(frm?.value.necessidadeDeManganes - frm?.value.totalExcessoDeficitManganes) * -1}}
                        </td>
                        <td
                            [ngClass]="(frm?.value.necessidadeDeZinco - frm?.value.totalExcessoDeficitZinco) * -1 < 0 ? 'table-danger' : (frm?.value.necessidadeDeZinco - frm?.value.totalExcessoDeficitZinco) * -1 > 0 ? 'table-warning' : (frm?.value.necessidadeDeZinco - frm?.value.totalExcessoDeficitZinco) * -1 === 0 ? 'table-success' : ''">
                            {{(frm?.value.necessidadeDeZinco - frm?.value.totalExcessoDeficitZinco) * -1}}
                        </td>
                    </tr>
                    <tr style="font-family: 'Courier New', Courier, monospace;">
                        <td colspan="1" style="text-align: right;">Legenda</td>
                        <td colspan="4">
                            <table>
                                <tr>
                                    <td class="table-danger" style="margin: 0px; padding: 0px;">
                                        Em falta
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table-warning" style="margin: 0px; padding: 0px;">
                                        Em excesso
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table-success" style="margin: 0px; padding: 0px;">
                                        Ok
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </tbody>
            </table>

            <table class="table table-striped m-4">
                <thead class="thead-dark text-center">
                    <tr>
                        <th colspan="3">TOTAIS / CUSTOS</th>
                    </tr>
                    <tr>
                        <th>Elemento</th>
                        <th>Custo por [{{frm.get('formaPlantio').value}}] (R$)</th>
                        <th>Custo por área plantada (R$)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Micronutriente</td>
                        <td class="text-right">0,00</td>
                        <td class="text-right">0,00</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Totais</th>
                        <th class="text-right">0,00</th>
                        <th class="text-right">0,00</th>
                    </tr>
                </tfoot>
            </table>

            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Próximo</button>
            </mat-action-row>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="step === 4" (opened)="setStep(4)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 5
                </mat-panel-title>
                <mat-panel-description>
                    Modo de Aplicação
                    <mat-icon>date_range</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>

            <table class="res-cabec">
                <tr>
                    <td>
                        MODO DE APLICAÇÃO
                    </td>
                </tr>
            </table>

            <table class="res" formGroupName="modoAplicacao">
                <tr>
                    <td width="80%">
                        SE FOR FEITA ADUBAÇÃO PARCELADA A LANÇO OU FERTIRRIGAÇÃO, INFORME QUANTAS VEZES POR MÊS OS
                        ADUBOS
                        SERÃO APLICADOS
                    </td>
                    <td width="20%">
                        <mat-form-field>
                            <mat-label>Valor</mat-label>
                            <input matInput type="number" class="text-right" formControlName="quantidadePorMes" min="0"
                                step="1">
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.quantidadePorMes?.errors?.required">
                                Campo Obrigatório!
                            </mat-error>
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.quantidadePorMes?.errors?.min">
                                Valor mínimo ({{frm.get('modoAplicacao')?.controls?.quantidadePorMes?.errors?.min.min}})
                                ultrapassado!
                            </mat-error>
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.quantidadePorMes?.errors?.max">
                                Valor máximo ({{frm.get('modoAplicacao')?.controls?.quantidadePorMes?.errors?.max.max}})
                                ultrapassado!
                            </mat-error>
                        </mat-form-field>
                    </td>
                </tr>
                <tr>
                    <td>
                        DURANTE QUANTOS MESES OS ADUBOS SERÃO APLICADOS
                    </td>
                    <td>
                        <mat-form-field>
                            <mat-label>Valor</mat-label>
                            <input matInput type="number" class="text-right" formControlName="totalMeses" min="0"
                                step="1">
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.totalMeses?.errors?.required">
                                Campo Obrigatório!
                            </mat-error>
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.totalMeses?.errors?.min">
                                Valor mínimo ({{frm.get('modoAplicacao')?.controls?.totalMeses?.errors?.min.min}})
                                ultrapassado!
                            </mat-error>
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.totalMeses?.errors?.max">
                                Valor máximo ({{frm.get('modoAplicacao')?.controls?.totalMeses?.errors?.max.max}})
                                ultrapassado!
                            </mat-error>
                        </mat-form-field>
                    </td>
                </tr>
                <tr>
                    <td>
                        TOTAL DE ADUBAÇÃO REALIZADAS DURANTE A SAFRA
                    </td>
                    <td>
                        <mat-form-field>
                            <mat-label>Valor</mat-label>
                            <input matInput type="number" class="text-right" formControlName="totalSafra" min="0"
                                step="1">
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.totalSafra?.errors?.required">
                                Campo Obrigatório!
                            </mat-error>
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.totalSafra?.errors?.min">
                                Valor mínimo ({{frm.get('modoAplicacao')?.controls?.totalSafra?.errors?.min.min}})
                                ultrapassado!
                            </mat-error>
                            <mat-error *ngIf="frm.get('modoAplicacao')?.controls?.totalSafra?.errors?.max">
                                Valor máximo ({{frm.get('modoAplicacao')?.controls?.totalSafra?.errors?.max.max}})
                                ultrapassado!
                            </mat-error>
                        </mat-form-field>
                    </td>
                </tr>
            </table>

            <p>
                [{{frm?.value.modoAplicacao | json}}]
            </p>

            <p>
                [{{frm?.value.cultura | json}}]
            </p>

            <ol type="1">
                <li *ngFor="let fp of frm?.value.cultura?.culturaFormaParcelamentoList">
                    Período (de {{fp.periodoInicial}} até {{fp.periodoFinal}} dias)
                    <ol type="1">
                        <li *ngFor="let fpg of fp.culturaFormaParcelamentoGarantiaList">
                            [Elemento {{fpg.garantia.nome}}] => {{fpg.quantidade}} 
                        </li>
                    </ol>
                </li>
            </ol>



            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Final</button>
            </mat-action-row>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="step === 5" (opened)="setStep(5)" hideToggle>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    PASSO 6
                </mat-panel-title>
                <mat-panel-description>
                    Resultado
                    <mat-icon>date_range</mat-icon>
                </mat-panel-description>
            </mat-expansion-panel-header>

            <table class="res-cabec">
                <tr>
                    <td>
                        FOLHA DE RECOMENDAÇÃO TÉCNICA
                    </td>
                </tr>
            </table>

            <table class="res">
                <tr>
                    <td>
                        NOME DO PROPRIETÁRIO
                    </td>
                    <td>
                        {{frm?.value.pessoa?.nome}}
                    </td>
                </tr>
                <tr>
                    <td>
                        DATA
                    </td>
                    <td>
                        {{frm?.value.data}}
                    </td>
                </tr>
            </table>

            <table class="res-cabec">
                <tr>
                    <td>
                        Recomendação de Adubação
                    </td>
                </tr>
            </table>

            <table class="res">
                <tr class="limpo">
                    <td>Número de plantas por hectare (100m x 100m):</td>
                    <td>{{frm?.value.espacamento?.quantidadePlanta}}</td>
                    <td>Área (ha):</td>
                    <td>{{frm?.value.espacamento?.area}}</td>
                </tr>
            </table>

            <table class="res">
                <tr>
                    <td colspan="4" style="text-align: center;">Dados de análise de solos</td>
                    <td>Sat. Bases</td>
                    <td>{{getReceitaAnaliseSoloParametro('sat_base')?.valor}}</td>
                    <td>Argila</td>
                    <td>{{getReceitaAnaliseSoloParametro('argila')?.valor}}</td>
                </tr>
                <tr>
                    <td>pH</td>
                    <td>{{getReceitaAnaliseSoloParametro('ph_h2o')?.valor}}</td>
                    <td>Na</td>
                    <td>{{getReceitaAnaliseSoloParametro('sodio')?.valor}}</td>
                    <td>M.O.</td>
                    <td>{{getReceitaAnaliseSoloParametro('mat_organica')?.valor}}</td>
                    <td>Mn</td>
                    <td>{{getReceitaAnaliseSoloParametro('magnesio')?.valor}}</td>
                </tr>
                <tr>
                    <td>Ca</td>
                    <td>{{getReceitaAnaliseSoloParametro('calcio')?.valor}}</td>
                    <td>P</td>
                    <td>{{getReceitaAnaliseSoloParametro('potassio')?.valor}}</td>
                    <td>B</td>
                    <td>{{getReceitaAnaliseSoloParametro('boro')?.valor}}</td>
                    <td>Zn</td>
                    <td>{{getReceitaAnaliseSoloParametro('zinco')?.valor}}</td>
                </tr>
                <tr>
                    <td>Mg</td>
                    <td>{{getReceitaAnaliseSoloParametro('manganes')?.valor}}</td>
                    <td>H+Al</td>
                    <td>{{getReceitaAnaliseSoloParametro('h_ai')?.valor}}</td>
                    <td>Cu</td>
                    <td>{{getReceitaAnaliseSoloParametro('cobre')?.valor}}</td>
                    <td>S</td>
                    <td>{{getReceitaAnaliseSoloParametro('sodio')?.valor}}</td>
                </tr>
                <tr>
                    <td>K</td>
                    <td>{{getReceitaAnaliseSoloParametro('calcio')?.valor}}</td>
                    <td>Al</td>
                    <td>{{getReceitaAnaliseSoloParametro('aluminio')?.valor}}</td>
                    <td>Fe</td>
                    <td>{{getReceitaAnaliseSoloParametro('ferro')?.valor}}</td>
                    <td>CTC</td>
                    <td>{{getReceitaAnaliseSoloParametro('ctc')?.valor}}</td>
                </tr>
            </table>

            <div *ngIf="frm?.value.calcarioPercentual || frm?.value.poDeRochaPercentual">
                <table class="res-cabec">
                    <tr>
                        <td>
                            CALAGEM E ROCHAGEM
                        </td>
                    </tr>
                </table>

                <table class="res">
                    <ng-template ngFor let-reg [ngForOf]="[
                    {adubo: frm?.value.calcario, perc: frm?.value.necessidadeCalcarioCorrigido}, 
                    {adubo: frm?.value.poDeRocha, perc: frm?.value.necessidadePoDeRochaCorrigido}]" let-i="index">
                        <tr *ngIf="reg.adubo">
                            <td rowspan="2" class="limpo">{{reg.adubo.nome}}</td>
                            <td class="limpo">{{reg.perc}}</td>
                            <td class="limpo">toneladas por hectare ou,</td>
                            <td class="limpo">Custo/área total</td>
                            <td class="limpo">{{reg.perc / 10}}</td>
                        </tr>
                        <tr *ngIf="reg.adubo">
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                            <!-- Pegar dados do preco do adubo -->
                            <td class="limpo">kilos por metro quadrado</td>
                            <td class="limpo">Custo/nº plantas</td>
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                        </tr>
                    </ng-template>
                </table>
                <p>
                    <strong>Aplicar da seguinte forma:</strong> a calagem/rochagem deve ser aplicada no final do período
                    chuvoso anterior ao plantio, ou ainda, no início da estação chuvosa pouco antes do plantio. Se a
                    dose de
                    calcario for elevada (maior que 5 a outra deverá ser de no mínimo 12 meses.
                </p>
            </div>

            <div *ngIf="frm?.value.receitaAmostragemSolo?.gesso">
                <table class="res-cabec">
                    <tr>
                        <td>
                            GESSAGEM
                        </td>
                    </tr>
                </table>

                <table class="res">
                    <ng-template ngFor let-reg [ngForOf]="[
                    {adubo: frm?.value.receitaAmostragemSolo?.gesso, perc: 0}]" let-i="index">
                        <tr *ngIf="reg.adubo">
                            <td rowspan="2" class="limpo">{{reg.adubo.nome}}</td>
                            <td class="limpo">{{reg.perc}}</td>
                            <td class="limpo">kilos por hectare ou,</td>
                            <td class="limpo">Custo/área total</td>
                            <td class="limpo">--</td>
                        </tr>
                        <tr *ngIf="reg.adubo">
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                            <!-- Pegar dados do preco do adubo -->
                            <td class="limpo">gramas por metro quadrado</td>
                            <td class="limpo">Custo/nº plantas</td>
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                        </tr>
                    </ng-template>
                </table>

                <p>
                    <strong>Aplicar da seguinte forma:</strong> o gesso agrícola deve ser aplicado a lanço depois da
                    calagem.
                </p>
            </div>

            <div *ngIf="getAdubosInformados().length">
                <table class="res-cabec">
                    <tr>
                        <td>
                            ADUBOS
                        </td>
                    </tr>
                </table>

                <table class="res">
                    <ng-template ngFor let-reg [ngForOf]="getAdubosInformados()" let-i="index">
                        <tr *ngIf="reg.adubo">
                            <td rowspan="2" class="limpo">{{reg.adubo.nome}}</td>
                            <td class="limpo">{{reg.perc}}</td>
                            <td class="limpo">toneladas por hectare ou,</td>
                            <td class="limpo">Custo/área total</td>
                            <td class="limpo">--</td>
                        </tr>
                        <tr *ngIf="reg.adubo">
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                            <!-- Pegar dados do preco do adubo -->
                            <td class="limpo">gramas por metro quadrado</td>
                            <td class="limpo">Custo/nº plantas</td>
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                        </tr>
                    </ng-template>
                </table>

                <p>
                    <strong>Aplicar da seguinte forma:</strong>
                </p>
                <ul>
                    <li>O adubo fosfatado e adubos orgânicos podem ser aplicado de uma única vez no início da estação
                        chuvosa.</li>
                    <li>Parcelar em três vezes, durante o período chuvoso, os adubos contendo nitrogênio e potássio.
                    </li>
                    <li>Fazer nova amostragem de solo a cada dois ou três anos.</li>
                </ul>
            </div>

            <div *ngIf="getMicroNutrientesInformados().length">
                <table class="res-cabec">
                    <tr>
                        <td>
                            USO DE ADUBOS COM MICRONUTRIENTES
                        </td>
                    </tr>
                </table>

                <table class="res">
                    <ng-template ngFor let-reg [ngForOf]="getMicroNutrientesInformados()" let-i="index">
                        <tr *ngIf="reg.adubo">
                            <td rowspan="2" class="limpo">{{reg.adubo.nome}}</td>
                            <td class="limpo">{{reg.perc}}</td>
                            <td class="limpo">toneladas por hectare ou,</td>
                            <td class="limpo">Custo/área total</td>
                            <td class="limpo">--</td>
                        </tr>
                        <tr *ngIf="reg.adubo">
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                            <!-- Pegar dados do preco do adubo -->
                            <td class="limpo">gramas por metro quadrado</td>
                            <td class="limpo">Custo/nº plantas</td>
                            <td class="limpo">{{reg.adubo.aduboPrecoList[0]}}</td>
                        </tr>
                    </ng-template>
                </table>

                <p>
                    <strong>Aplicar da seguinte forma:</strong>
                </p>
                <ol type="a">
                    <li>
                        Os micronutrientes podem ser misturados e aplicados juntos aos outros adubos fontes de
                        nitrogênio, fósforo e potássio</li>
                    <li>
                        A reaplicação de micronutrientes pode ser necessária após 4 anos, de acordo com análise do solo
                    </li>
                </ol>
            </div>

            <table class="res-cabec">
                <tr>
                    <td>
                        CUSTOS
                    </td>
                </tr>
            </table>

            <table class="res">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>

            <!-- <table>
                <tr>
                    <td rowspan="2">
                        PARA OBTER O MENOR CUSTO
                    </td>
                    <td>Custo/área total</td>
                    <td><input value="2794,51057848193"></td>
                </tr>
                <tr>
                    <td>Custo/planta </td>
                    <td><input value="22,3560846278554"></td>
                </tr>
            </table>
             -->
            <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Anterior</button>
                <button mat-button color="primary" (click)="nextStep()">Final</button>
            </mat-action-row>
        </mat-expansion-panel>

    </mat-accordion>
</form>
<!-- [{{frm?.value | json}}] -->